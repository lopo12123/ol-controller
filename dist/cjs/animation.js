"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("ol"),t=require("ol/layer/Vector"),r=require("ol/geom"),i=require("ol/source/Vector"),s=require("ol/style"),a=require("ol/render");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t),l=n(i);exports.AnimationController=class{#e;#t;#r;#i;#s;#a=!1;get playing(){return this.#a}#n;#o;#l=0;#h=null;#c=-1;constructor(t,i,a,n=1e5,h,c){if(i.length<=1)throw new Error("[OlController] Your animation-path is too short, need 2 point at least!");this.#e=t,this.#n=n,this.#o=1e5/n,this.#h=c??null;const p=new l.default,y=new o.default({source:p});this.#t=y;const d=new r.LineString(i),u=new e.Feature(d);u.setStyle(new s.Style({stroke:new s.Stroke({width:h?.width??6,color:h?.stroke??"#39c"})})),p.addFeature(u),this.#r=d;const _=new e.Feature({geometry:new r.Point(i[0])});if(_.setStyle(new s.Style({image:new s.Icon({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:a.player})})),p.addFeature(_),this.#i=_,this.#s=_.getGeometry(),a.start){const t=new e.Feature({geometry:new r.Point(i[0])});t.setStyle(new s.Style({image:new s.Icon({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:a.start})})),p.addFeature(t)}if(a.end){const t=new e.Feature({geometry:new r.Point(i[i.length-1])});t.setStyle(new s.Style({image:new s.Icon({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:a.end})})),p.addFeature(t)}this.#e.addLayer(y)}setDuration(e){this.#n=e}#p=(e=>{const t=e.frameState.time,r=t-this.#c;if(this.#l=this.#l+r/this.#n,this.#c=t,this.#h?.(this.#l),this.#l>1)this.reset();else{const t=this.#r.getCoordinateAt(this.#l);this.#s.setCoordinates(t);const r=a.getVectorContext(e);r.setStyle(this.#i.getStyle()),r.drawGeometry(this.#s),this.#e?.render()}}).bind(this);play(){this.#a||(this.#a=!0,this.#c=Date.now(),this.#t.on("postrender",this.#p),this.#i.setGeometry(null))}pause(){this.#a&&(this.#a=!1,this.#i.setGeometry(this.#s),this.#t.un("postrender",this.#p))}reset(e=!1){this.pause(),this.#l=0,this.#h?.(0),e&&(this.#o=1)}toggle_visible(e){this.#t.setVisible(e??!this.#t.getVisible())}dispose(){this.pause(),this.#e?.removeLayer(this.#t),this.#e=null}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0aW9uLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvYW5pbWF0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbbnVsbF0sIm5hbWVzIjpbIm1hcCIsImxheWVyIiwicm91dGUiLCJwbGF5ZXIiLCJwbGF5ZXJfZ2VvIiwicGxheWluZyIsInRoaXMiLCJkdXJhdGlvbiIsInNwZWVkIiwiZGlzX3BlcmNlbnQiLCJwZXJjZW50VXBkYXRlQ0IiLCJsYXN0X3JhZl90aW1lIiwiY29uc3RydWN0b3IiLCJwYXRoIiwiaWNvbnMiLCJzdHlsZSIsImxlbmd0aCIsIkVycm9yIiwiYW5pbWF0aW9uX3NvdXJjZSIsIlZlY3RvclNvdXJjZSIsImFuaW1hdGlvbl9sYXllciIsIlZlY3RvckxheWVyIiwic291cmNlIiwiTGluZVN0cmluZyIsInJvdXRlX2ZlYXR1cmUiLCJGZWF0dXJlIiwic2V0U3R5bGUiLCJTdHlsZSIsInN0cm9rZSIsIlN0cm9rZSIsIndpZHRoIiwiY29sb3IiLCJhZGRGZWF0dXJlIiwicGxheWVyX2ZlYXR1cmUiLCJnZW9tZXRyeSIsIlBvaW50IiwiaW1hZ2UiLCJJY29uIiwiYW5jaG9yIiwiYW5jaG9yWFVuaXRzIiwiYW5jaG9yWVVuaXRzIiwic3JjIiwiZ2V0R2VvbWV0cnkiLCJzdGFydCIsImVuZCIsImFkZExheWVyIiwic2V0RHVyYXRpb24iLCJhbmltYXRpb25fY2FsbGJhY2tfZm9yX3NlbGYiLCJldiIsImN1cnJfcmFmX3RpbWUiLCJmcmFtZVN0YXRlIiwidGltZSIsImVsYXBzZWRUaW1lIiwicmVzZXQiLCJjdXJyX2Nvb3JkaW5hdGUiLCJnZXRDb29yZGluYXRlQXQiLCJzZXRDb29yZGluYXRlcyIsInZlY3RvckN0eCIsImdldFZlY3RvckNvbnRleHQiLCJnZXRTdHlsZSIsImRyYXdHZW9tZXRyeSIsInJlbmRlciIsImJpbmQiLCJwbGF5IiwiRGF0ZSIsIm5vdyIsIm9uIiwic2V0R2VvbWV0cnkiLCJwYXVzZSIsInVuIiwicmVzZXRfc3BlZWQiLCJ0b2dnbGVfdmlzaWJsZSIsInRvIiwic2V0VmlzaWJsZSIsImdldFZpc2libGUiLCJkaXNwb3NlIiwicmVtb3ZlTGF5ZXIiXSwibWFwcGluZ3MiOiIyVUFXQSxNQUlJQSxHQUtTQyxHQUtBQyxHQUtBQyxHQUlBQyxHQUtUQyxJQUFXLEVBSVBBLGNBQ0EsT0FBT0MsTUFBS0QsRUFNaEJFLEdBSUFDLEdBSUFDLEdBQWUsRUFJTkMsR0FBNEQsS0FLckVDLElBQWtCLEVBV2xCQyxZQUNJWixFQUNBYSxFQUNBQyxFQUtBUCxFQUFtQixJQUNuQlEsRUFJQUwsR0FDQSxHQUFHRyxFQUFLRyxRQUFVLEVBQUcsTUFBTSxJQUFJQyxNQUFNLDJFQUVyQ1gsTUFBS04sRUFBT0EsRUFDWk0sTUFBS0MsRUFBWUEsRUFDakJELE1BQUtFLEVBQVMsSUFBVUQsRUFDeEJELE1BQUtJLEVBQW1CQSxHQUFtQixLQUszQyxNQUFNUSxFQUFtQixJQUFJQyxFQUFBQSxRQUN2QkMsRUFBa0IsSUFBSUMsRUFBVyxRQUFDLENBQUVDLE9BQVFKLElBRWxEWixNQUFLTCxFQUFTbUIsRUFJZCxNQUFNbEIsRUFBUSxJQUFJcUIsYUFBV1YsR0FDdkJXLEVBQWdCLElBQUlDLFVBQVF2QixHQUNsQ3NCLEVBQWNFLFNBQVMsSUFBSUMsUUFBTSxDQUM3QkMsT0FBUSxJQUFJQyxFQUFBQSxPQUFPLENBQ2ZDLE1BQU9mLEdBQU9lLE9BQVMsRUFDdkJDLE1BQU9oQixHQUFPYSxRQUFVLFlBSWhDVixFQUFpQmMsV0FBV1IsR0FDNUJsQixNQUFLSixFQUFTQSxFQUlkLE1BQU0rQixFQUFpQixJQUFJUixVQUFRLENBQy9CUyxTQUFVLElBQUlDLEVBQUFBLE1BQU10QixFQUFLLE1BaUI3QixHQWZBb0IsRUFBZVAsU0FBUyxJQUFJQyxRQUFNLENBQzlCUyxNQUFPLElBQUlDLEVBQUFBLEtBQUssQ0FDWkMsT0FBUSxDQUFFLEdBQUssSUFDZkMsYUFBYyxXQUNkQyxhQUFjLFdBQ2RDLElBQUszQixFQUFNWCxZQUluQmUsRUFBaUJjLFdBQVdDLEdBQzVCM0IsTUFBS0gsRUFBVThCLEVBQ2YzQixNQUFLRixFQUFjNkIsRUFBZVMsY0FJN0I1QixFQUFNNkIsTUFBTyxDQUNkLE1BQU1BLEVBQVEsSUFBSWxCLFVBQVEsQ0FDdEJTLFNBQVUsSUFBSUMsRUFBQUEsTUFBTXRCLEVBQUssTUFFN0I4QixFQUFNakIsU0FBUyxJQUFJQyxRQUFNLENBQ3JCUyxNQUFPLElBQUlDLEVBQUFBLEtBQUssQ0FDWkMsT0FBUSxDQUFFLEdBQUssSUFDZkMsYUFBYyxXQUNkQyxhQUFjLFdBQ2RDLElBQUszQixFQUFNNkIsV0FHbkJ6QixFQUFpQmMsV0FBV1csR0FLaEMsR0FBSzdCLEVBQU04QixJQUFLLENBQ1osTUFBTUEsRUFBTSxJQUFJbkIsVUFBUSxDQUNwQlMsU0FBVSxJQUFJQyxFQUFBQSxNQUFNdEIsRUFBS0EsRUFBS0csT0FBUyxNQUUzQzRCLEVBQUlsQixTQUFTLElBQUlDLFFBQU0sQ0FDbkJTLE1BQU8sSUFBSUMsRUFBQUEsS0FBSyxDQUNaQyxPQUFRLENBQUUsR0FBSyxJQUNmQyxhQUFjLFdBQ2RDLGFBQWMsV0FDZEMsSUFBSzNCLEVBQU04QixTQUduQjFCLEVBQWlCYyxXQUFXWSxHQU1oQ3RDLE1BQUtOLEVBQUs2QyxTQUFTekIsR0FNdkIwQixZQUFZdkMsR0FDUkQsTUFBS0MsRUFBWUEsRUFPckJ3QyxJQUFpQ0MsSUFFN0IsTUFBTUMsRUFBZ0JELEVBQUdFLFdBQVlDLEtBQy9CQyxFQUFjSCxFQUFnQjNDLE1BQUtLLEVBUXpDLEdBUEFMLE1BQUtHLEVBQWVILE1BQUtHLEVBQWUyQyxFQUFjOUMsTUFBS0MsRUFDM0RELE1BQUtLLEVBQWlCc0MsRUFHdEIzQyxNQUFLSSxJQUFtQkosTUFBS0csR0FHMUJILE1BQUtHLEVBQWUsRUFDbkJILEtBQUsrQyxZQUdKLENBR0QsTUFBTUMsRUFBa0JoRCxNQUFLSixFQUFPcUQsZ0JBQWdCakQsTUFBS0csR0FFekRILE1BQUtGLEVBQVlvRCxlQUFlRixHQUdoQyxNQUFNRyxFQUFZQyxtQkFBaUJWLEdBQ25DUyxFQUFVL0IsU0FBU3BCLE1BQUtILEVBQVF3RCxZQUNoQ0YsRUFBVUcsYUFBYXRELE1BQUtGLEdBRzVCRSxNQUFLTixHQUFNNkQsWUFFaEJDLEtBQUt4RCxNQUtSeUQsT0FFUXpELE1BQUtELElBRUxDLE1BQUtELEdBQVcsRUFHaEJDLE1BQUtLLEVBQWlCcUQsS0FBS0MsTUFHM0IzRCxNQUFLTCxFQUFPaUUsR0FBRyxhQUFjNUQsTUFBS3lDLEdBR2xDekMsTUFBS0gsRUFBUWdFLFlBQVksT0FPakNDLFFBRU85RCxNQUFLRCxJQUVKQyxNQUFLRCxHQUFXLEVBR2hCQyxNQUFLSCxFQUFRZ0UsWUFBWTdELE1BQUtGLEdBRTlCRSxNQUFLTCxFQUFPb0UsR0FBRyxhQUFjL0QsTUFBS3lDLElBVTFDTSxNQUFNaUIsR0FBdUIsR0FDekJoRSxLQUFLOEQsUUFDTDlELE1BQUtHLEVBQWUsRUFDcEJILE1BQUtJLElBQW1CLEdBRXJCNEQsSUFDQ2hFLE1BQUtFLEVBQVMsR0FRdEIrRCxlQUFlQyxHQUNYbEUsTUFBS0wsRUFBT3dFLFdBQVdELElBQU9sRSxNQUFLTCxFQUFPeUUsY0FNOUNDLFVBQ0lyRSxLQUFLOEQsUUFDTDlELE1BQUtOLEdBQU00RSxZQUFZdEUsTUFBS0wsR0FDNUJLLE1BQUtOLEVBQU8ifQ==
